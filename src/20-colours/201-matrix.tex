
\section{Macierz kolorująca i~wyznacznik}
\index{macierz!kolorująca|(}%
Zajmiemy się teraz wyznacznikiem, pierwszym nieoczywistym niezmiennikiem splotów, który przypisuje każdemu pewną liczbę całkowitą.
Jest on blisko związany z~kolorowaniem.
Zauważmy, że pierwszy ruch Reidemeistera usuwa zamknięte krzywe, czyli pojedyncze łuki bez skrzyżowań.
Diagram bez takich krzywych ma tyle samo skrzyżowań, co łuków.

\begin{definition}[macierz kolorująca]
    Ustalmy diagram bez zamkniętych krzywych dla splotu $L$ z~łukami $x_0, \ldots, x_m$ oraz skrzyżowaniami $0, \ldots, m$.
    Definiujemy macierz $A_+$, której wyraz $a_{lj}$ jest współczynnikiem przy $x_j$ w~$l$-tym równaniu kolorującym:
\begin{comment}
    \[
        \LargePlusCrossingMatrix
    \]
\end{comment}
    Macierz kolorująca $A$ powstaje z~macierzy $A_+$ przez skreślenie dowolnego wiersza i~kolumny.
\end{definition}

Taka macierz jest kwadratowa, ponieważ z~każdego skrzyżowania wychodzą (tunelem) dwa włókna mające dwa końce.
Wykreślenie wiersza i~kolumny jest konieczne.
Gdybyśmy tego zaniechali, otrzymana macierz nie byłaby odwracalna, bowiem wiersze sumują się do zera (patrz fakt \ref{prp:colouring_sum_zero}).
Dla alternujących diagramów możemy żądać, by górą $i$-tego skrzyżowania biegło $i$-te włókno, wtedy na diagonali macierzy $A$ znajdą się same minus dwójki.

\index{wyznacznik|(}
\begin{definition}[wyznacznik]
\label{def:determinant}%
    Wyznacznikiem splotu nazywamy wyznacznik macierzy kolorującej $A$ bez znaku: $\det K := |\det A_K|$.
    Za wyznacznik niewęzła przyjmujemy liczbę $1$.
\end{definition}

\begin{definition}[defekt]
\index{defekt}%
    Wymiar jądra macierzy kolorującej modulo $p$, defekt, nazywamy defektem węzła.
\end{definition}

\begin{proposition}
\label{no_relation_defects}%
    Defekty modulo różne liczby pierwsze są niezależne od siebie.
\end{proposition}

\begin{proof}
    Na przykład suma spójna $k$ trójlistników i~$j$ węzłów $T_{2,5}$ posiada defekt $k$ modulo $3$ oraz $j$ modulo $5$.
    Podobne przykłady istnieją dla innych zbiorów liczb pierwszych.
\end{proof}

Pokażemy później (po poznaniu grupy kolorującej, czyli we wniosku \ref{cor:determinant_invariant}) lub jeszcze później (po wprowadzeniu wielomianu Alexandera, w~dowodzie faktu \ref{alexander_invariance}), że wyznacznik splotu jest dobrze określony: nie zależy on od wyboru etykietowania, minora macierzy oraz diagramu i~że jest niezmiennikiem.
Teraz ograniczymy się do jego kilku własności.

Defekt także jest niezmiennikiem, choć rzadziej używanym.
Węzeł o~defekcie $n$ modulo $p$ posiada $p(p^n-1)$ kolorowań $p$ kolorami.
Węzły $8_{18}$ oraz $9_{24}$ mają ten sam wyznacznik, $45$.
Ich defekty modulo $3$ to $1$ i~$2$, zatem są różne.

% Każde $p$-kolorowanie węzła $n$-mostowego jest wyznaczone przez kolory $n$ mostów
% % To brzmi podejrzanie: więc przestrzeń kolorowań ma wymiar co najwyżej $n$ i~defekt modulo $p$ nie przekracza $\operatorname{br} - 1$.
% Wnioskujemy stąd, że $(3,3,3)$-precel nie jest dwumostowy.

% \begin{proof}
%     \emph{Krok pierwszy}.
%     Pokażemy, że żaden ruch Reidemeistera nie zmienia wyznacznika.
%     \begin{enumerate}
%         \item \emph{Ruch $R_1$}. Diagram przed lub po ruchu zawiera co najmniej jedno włókno, które łączy tunel z~mostem pewnego skrzyżowania.
%         \item \emph{Ruch $R_2$}.
%         \item \emph{Ruch $R_3$}.
%     \end{enumerate}

%     \emph{Krok drugi}.
%     Niech $A_{i,j}$ oznacza minor powstały przez skreślenie $i$-tego wiersza oraz $j$-tej kolumny.
%     Pokażemy, że wartość wyznacznika nie zależy od wyboru $i$ oraz $j$.

%     Niech $X$ będzie macierzą $k \times k$ złożoną z~samych jedynek.
%     Suma elementów w~każdej kolumnie oraz każdym wierszu macierzy $A + X$ wynosi $k$, ponieważ znaki równań zostały dobrze wybrane.
%     Wykonujemy kolejno operacje:
%     \begin{enumerate}
%         \item Dodajemy do $i$-tego wiersza sumę pozostałych.
%         \item Dodajemy do $j$-tej kolumny sumę pozostałych.
%         Teraz $i$-ty wiersz oraz $j$-ta kolumna zawierają wyrazy $k$ z~wyjątkiem $a_{ij}$, który wynosi $k^2$.
%         \item Wyciągamy $k$ z~$i$-tego wiersza przed wyznacznik.
%         \item Odejmujemy $i$-ty wiersz od pozostałych.
%     \end{enumerate}
%     Rozwinięcie Laplace'a względem $j$-tej kolumny mówi, że $|\det (A+X)| = k^2 |(-1)^{i+j} \det A_{i,j}|$, co kończy dowód drugiego kroku.

%     \emph{Krok trzeci}.
%     Pokażemy, że zmiana etykietowania nie zmienia wyznacznika.
% \end{proof}

\begin{proposition}
\label{prp:bankwitz}%
\index{indeks skrzyżowaniowy}
    Niech $L$ będzie splotem alternującym.
    Wtedy $\det L \ge \crossing L$.
\end{proposition}

Pierwszy niepoprawny dowód pochodzi od Bankwitza \cite{bankwitz30}, który w 1930 roku ograniczył się do węzłów.
\index{człowiek!Bankwitz, ?}%
Poprawny dowód pojawił się dopiero trzy dekady później, kiedy Crowell \cite{crowell59} oparł się o~teoriografową pracę Whittneya.
\index{człowiek!Crowell, Richard}%
\index{człowiek!Whittney, ?}%
Spośród 84 diagramów pierwszych węzłów na końcu podręcznika Reidemeistera, 11 ma niealternujący diagram.
Crowell pokazał, że 7 z~tych 11 przedstawia niealternujące węzły.

\begin{example}
    $\det 8_{19} = 3 < 8 = \crossing 8_{19}$, więc węzeł $8_{19}$ jest niealternujący.
    Podobnie dowodzi się, że $9_{42}$, $10_{124}$, $10_{132}$, $10_{139}$, $10_{140}$, $10_{145}$, $10_{153}$, $10_{161}$, 21 węzłów pierwszych o~11 skrzyżowaniach oraz 75 węzłów pierwszych o~12 skrzyżowaniach nie są alternujące.
\end{example}

Niealternujących węzłów o 11 (odpowiednio: 12) skrzyżowaniach jest 185 (888), zatem ta prosta nierówność nie daje niesamowitch efektów.
Ale Crowell znalazł też mocniejsze ograniczenie:

\begin{proposition}
    Niech $L$ będzie pierwszym, alternującym splotem, który nie jest $(2, n)$-torusowy.
    Wtedy $\det L + 3 \ge 2 \crossing L$
\end{proposition}

Wyznacznik jest blisko związany z kolorowaniami.

\begin{lemma}
    Niech $A$ będzie macierzą $r \times r$ o całkowitych wyrazach.
    Istnieje niezerowy wektor $x \in (\Z/n\Z)^r$ taki, że $Ax \equiv 0 \mod n$ wtedy i tylko wtedy, gdy liczby $\det A$ oraz $n$ nie są względnie pierwsze.
\end{lemma}

\begin{proof}
    Z~algebry liniowej wiemy, że dla pewnych odwracalnych całkowitoliczbowych macierzy $C, R$ macierz $RAC = \operatorname{diag}(a_1, \ldots, a_m)$ jest diagonalna: to postać normalna Smitha.
    Istnieje odpowiedniość między niezerowymi rozwiązaniami równania $Ax \equiv 0$ oraz $Dy \equiv 0$, mamy bowiem $x \equiv Cy$, zatem bez straty ogólności możemy przyjąć, że macierz $A$ jest diagonalna.

    Istnieje niezerowy wektor $x$ taki, że $Ax \equiv 0 \mod n$ wtedy i tylko wtedy, jeśli istnieją $x_1, \ldots, x_m \in \Z/n\Z$, nie wszystkie zerowe, że dla każdego $i$ mamy $a_ix_i \equiv 0 \mod n$.
    Oznacza to, że dla pewnego $i$ liczby $a_i, n$ nie są względnie pierwsze.
    Macierz $A$ jest diagonalna, więc jej wyznacznik ma postać $\det A = \pm |a_1| \cdot \ldots \cdot |a_m|$.
    Wnioskujemy stąd, że liczby $\det A, n$ także nie są względnie pierwsze.
\end{proof}

\begin{proposition}
\label{prp:colour_determinant}%
    Splot $L$ koloruje się modulo $n$ wtedy i~tylko wtedy, gdy liczby $\det L$ oraz $n$ nie są względnie pierwsze.
\end{proposition}

\begin{proof}
    Wybierzmy diagram dla splotu $L$ z uporządkowanymi łukami i skrzyżowaniami.
    Bez straty ogólności ograniczmy się do tych kolorowań, gdzie $x_0 = 0$.
    Kolorowanie modulo $n$ istnieje dokładnie wtedy, gdy istnieje niezerowy wektor $(x_1, x_2, \ldots, x_m)$ taki, że $Ax \equiv 0 \mod n$.
    Na mocy lematu oraz definicji $\det L = |\det A|$, dowód zostaje zakończony.
\end{proof}

\begin{corollary}
    Jeżeli wyznacznik splotu $L$ wynosi $\det L = 1$, to splot $L$ jest niewidzialny.
\index{węzeł!niewidzialny}%
\end{corollary}

\begin{corollary}
    Jeżeli wyznacznik splotu $L$ wynosi $\det L = 0$, to splot $L$ koloruje się modulo wszystkie liczby naturalne.
\end{corollary}

\begin{corollary}
\index{splot!rozszczepialny}%
    Jeśli splot $L$ jest rozszczepialny, to jego wyznacznik wynosi $0$.
\end{corollary}

Poniższy problem pochodzi od Stojmenowa.

\begin{conjecture}[problem 12.25 w \cite{ohtsuki02}]
    Niech $n$ będzie nieparzystą sumą dwóch kwadratów.
    Czy istnieje pierwszy, alternujący, achiralny węzeł o~wyznaczniku $n$?
\end{conjecture}

Oto, co już wiemy.
Dla $n = 1, 9, 49$ oraz być może pewnej liczby $n > 2000$ niebędącej kwadratem, taki węzeł nie istnieje.
Jeśli istnieje achiralny węzeł o wyznaczniku $n$, to $n$ jest nieparzystą sumą dwóch kwadratów (\cite{hartley79}).
\index{człowiek!Hartley, Richard}%
Implikacja odwrotna także jest prawdziwa, od węzła można dodatkowo żądać bycia pierwszym lub alternującym, ale nie zawsze obydwu warunków jednocześnie.
Patrz też \cite{stoimenow05}.
\index{człowiek!Stoimenow, Alexander}%

\index{wyznacznik|)}

\index{macierz!Goeritza|(}
Istnieje jeszcze jedna kombinatoryczna metoda badania węzłów, która prowadzi między innymi do pojęcia wyznacznika.
Tuż przed wojną Lebrecht Goeritz pokazał, jak diagram węzła wyznacza specjalną formę kwadratową.
\index{człowiek!Goeritz, Lebrecht}%
Nieco później Trotter zmodyfikował jego pomysł, by sygnatura formy stanowiła niezmiennik splotów.
\index{człowiek!Trotter, Hale}%
Gordon, Litherland ujednolicili dwa wyżej wymienione podejścia w~pracy \cite{litherland81}.
\index{człowiek!Litherland, ?}%
\index{człowiek!Gordon, Cameron}%
My opiszemy krótko macierz Goeritza.

Ustalmy uszachowiony diagram $D$ dla splotu $L$.
\index{uszachowienie}%
Oznaczmy białe obszary $0, 1, \ldots, m$, przy czym $0$ jest obszarem nieograniczonym.
Przydzielmy skrzyżowaniom znaki:
\begin{comment}
\begin{figure}[H]
    \begin{minipage}[b]{.48\linewidth}
    \[
        \LargePlusCrossingChessboard
    \]
    \end{minipage}
    \begin{minipage}[b]{.48\linewidth}
    \[
        \LargeMinusCrossingChessboard
    \]
    \end{minipage}
\end{figure}
\end{comment}

\begin{definition}
    Macierz Goeritza powstaje przez skreślenie z~macierzy $G_+$ jednego wiersza oraz jednej kolumny:
    \begin{equation}
        G_+=\begin{pmatrix}
        G_{00} & \cdots & G_{0m} \\
        \vdots & \ddots & \vdots \\
        G_{m0} & \cdots & G_{mm}
        \end{pmatrix},
    \end{equation}
    gdzie jeśli $i\neq j$, to $G_{ij}$ jest sumą znaków skrzyżowań przyległych do $i$ oraz $j$.
    Dla $i = j$, $G_{ii}$ jest minus sumą znaków skrzyżowań wokół $j$-tego obszaru.
\end{definition}
% M. Kneser, D. Puppe, Quadratische Formen und Verschlingungsinvarianten von Knoten, Math. Z., 58, 1953, 376-384.
% R. H. Kyle, Branched covering spaces and the quadratic forms of links, Ann. of Math., 59(2), 1954, 539-548.

Macierz $G_+$ posiada dwie własności pozwalające wykryć proste błędy rachunkowe: jest symetryczna, a~jej kolumny i~wiersze sumują się do zera.
Jest przy tym zazwyczaj mniejsza od macierzy kolorującej.

\begin{proposition}
    Niech $K$ będzie ustalonym węzłem, $G$ jego macierzą Goeritza, zaś $A$ macierzą kolorującą.
    Z~dokładnością do znaku, obie macierze mają ten sam wyznacznik: $\det G = \pm \det A$.
\end{proposition}

Nie możemy niestety podać dowodu tego faktu, wymaga bowiem znajomości topologii algebraicznej, której wolelibyśmy nie zakładać.
Macierz Goeritza nie jest niezmiennikiem splotów.
Mamy jednak:

\begin{proposition}
    Niech $D_1, D_2$ będą dwoma diagramami ustalonego splotu.
    Wtedy macierz Goeritza $G_2$ można otrzymać z macierzy $G_1$ w skończonej liczbie kroków:
    \begin{enumerate}%[leftmargin=*]
    %\itemsep0em
        \item zamiany macierzy $G$ na $PGP^{-1}$, gdzie $P$ i~$P^{-1}$ mają całkowite wyrazy
        \item dopisania lub skreślenia $\pm 1$ na końcu przekątnej (dla węzłów) albo $-1, 0, 1$ (dla splotów).
    \end{enumerate}
\end{proposition}

\begin{proof}
\index{człowiek!Goeritz, Lebrecht}%
\index{człowiek!Kneser, ?}%
\index{człowiek!Puppe, ?}%
\index{człowiek!Kyle, ?}%
    Patrz prace: Goeritza \cite{goeritz33} i późniejsze, Knesera, Puppego \cite{kneser53} oraz Kyle'a \cite{kyle54}.
    % znalazłem te dowody w https://arxiv.org/pdf/0909.1118.pdf
\end{proof}

\index{macierz!Goeritza|)}

\index{macierz!kolorująca|)}

% Koniec sekcji Macierz i~wyznacznik

